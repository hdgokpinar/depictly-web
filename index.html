<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Depictly</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #111432;
    color: white;
  }
  #menu {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    gap: 20px;
  }
  .menu-logo {
    max-width: 300px;
    height: auto;
  }
  .menu-btn {
    padding: 10px 20px;
    background: #2b3c80;
    border: none;
    color: white;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
  }
  .menu-btn:hover {
    background: #3f54a6;
  }
  #appWrap {
    display: none;
    padding: 10px;
  }
  #toolbar {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
  }
  canvas {
    background: white;
    display: block;
    margin: auto;
    border: 2px solid #333;
    touch-action: none;
  }
  #overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.8);
    color: white;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
  }
</style>
</head>
<body>

<!-- Main Menu -->
<div id="menu">
  <!-- NEW LOGO -->
  <img class="menu-logo" src="images/depictly-logo.jpeg" alt="Depictly logo" />
  <button class="menu-btn" onclick="showApp()">Start Drawing</button>
  <button class="menu-btn" onclick="showHelp()">Help</button>
  <button class="menu-btn" onclick="showAbout()">About</button>
</div>

<!-- Drawing App -->
<div id="appWrap">
  <div id="toolbar">
    Color: <input type="color" id="color" value="#000000" />
    Size: <input type="range" id="size" min="1" max="50" value="5" />
    <span id="sizeVal">5 px</span>
    <button id="eraser">Eraser: Off</button>
    <button id="undo">Undo</button>
    <button id="redo">Redo</button>
    <button id="clear">Clear</button>
    <button id="save">Save</button>
  </div>
  <canvas id="draw" width="800" height="600"></canvas>
</div>

<!-- Overlay -->
<div id="overlay"></div>

<script>
const canvas = document.getElementById('draw');
const ctx = canvas.getContext('2d');
let drawing = false;
let eraser = false;
let brushColor = document.getElementById('color').value;
let brushSize = document.getElementById('size').value;
let lastPoint = null;
let history = [];
let historyStep = -1;

function saveState() {
  history = history.slice(0, historyStep + 1);
  history.push(canvas.toDataURL());
  historyStep++;
}
function restoreState(step) {
  let img = new Image();
  img.src = history[step];
  img.onload = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0);
  };
}

canvas.addEventListener('mousedown', (e) => {
  drawing = true;
  lastPoint = { x: e.offsetX, y: e.offsetY };
});
canvas.addEventListener('mouseup', () => {
  if (drawing) saveState();
  drawing = false;
  lastPoint = null;
});
canvas.addEventListener('mouseleave', () => {
  drawing = false;
  lastPoint = null;
});
canvas.addEventListener('mousemove', (e) => {
  if (!drawing) return;
  ctx.strokeStyle = eraser ? '#111432' : brushColor;
  ctx.lineWidth = brushSize;
  ctx.lineCap = 'round';
  ctx.beginPath();
  ctx.moveTo(lastPoint.x, lastPoint.y);
  ctx.lineTo(e.offsetX, e.offsetY);
  ctx.stroke();
  lastPoint = { x: e.offsetX, y: e.offsetY };
});

document.getElementById('color').oninput = e => brushColor = e.target.value;
document.getElementById('size').oninput = e => {
  brushSize = e.target.value;
  document.getElementById('sizeVal').textContent = `${brushSize} px`;
};
document.getElementById('eraser').onclick = () => {
  eraser = !eraser;
  document.getElementById('eraser').textContent = `Eraser: ${eraser ? 'On' : 'Off'}`;
};
document.getElementById('undo').onclick = () => {
  if (historyStep > 0) {
    historyStep--;
    restoreState(historyStep);
  }
};
document.getElementById('redo').onclick = () => {
  if (historyStep < history.length - 1) {
    historyStep++;
    restoreState(historyStep);
  }
};
document.getElementById('clear').onclick = () => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  saveState();
};
document.getElementById('save').onclick = () => {
  const url = canvas.toDataURL('image/png');
  const a = document.createElement('a');
  a.href = url;
  a.download = 'drawing.png';
  a.click();
};

function showApp() {
  document.getElementById('menu').style.display = 'none';
  document.getElementById('appWrap').style.display = 'block';
  document.getElementById('overlay').style.display = 'none';
  saveState();
}
function showHelp() {
  document.getElementById('overlay').style.display = 'flex';
  document.getElementById('overlay').innerHTML =
    `<div><h2>Help</h2><p>Use mouse or touch to draw. Change color and size. Undo/Redo. Save as PNG.</p><button onclick="closeOverlay()">Close</button></div>`;
}
function showAbout() {
  document.getElementById('overlay').style.display = 'flex';
  document.getElementById('overlay').innerHTML =
    `<div><h2>About Depictly</h2><p>Depictly is a simple web drawing app.</p><button onclick="closeOverlay()">Close</button></div>`;
}
function closeOverlay() {
  document.getElementById('overlay').style.display = 'none';
}

document.getElementById('menu').style.display = 'flex';
document.getElementById('appWrap').style.display = 'none';
document.getElementById('overlay').style.display = 'none';
</script>

</body>
</html>
